---
title: "summer_deq"
author: "Gillian McGinnis"
date: "6/17/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(lubridate)
```

```{r inputs}
input_deq_path <- "data/deq/Portland SE Lafayette.xlsx"

input_deq_renames <- c(
  "Date Time" = "date_time",
  "PM2.5" = "pm2.5_deq",
  "Temperature" = "temp_c",
  "Relative Humidity" = "rh",
  "Wind Speed (mph)" = "wind_mph",
  "Sigma Theta" = "sigma_theta"
)
```


```{r data_import}
data_deq_names <- read_excel(input_deq_path,
                             sheet = 1,
                             skip = 2,
                             n_max = 0) %>% names()

data_deq_raw <- read_excel(input_deq_path,
                           sheet = 1,
                           skip = 4,
                           na = "----",
                           col_names = data_deq_names)

remove(data_deq_names)
```

```{r data_wrangling}
data_deq_wrangled <- data_deq_raw %>% 
    mutate(`Date Time` = parse_date_time(`Date Time`,
                                       "%H:%M %m/%d/%Y",
                                       tz = "Etc/GMT+8")) %>% 
  plyr::rename(warn_missing = FALSE, input_deq_renames) %>% 
  select(intersect(all_of(input_deq_renames), names(.)))
```

